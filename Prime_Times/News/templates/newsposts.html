<!--prettier-ignore-->
{% extends "base.html" %} 
{% block content %}

<!-- Search Results Header -->
{% if search_query %}
<div class="mb-6 p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg">
  <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between">
    <div class="mb-2 sm:mb-0">
      <h2 class="text-lg font-semibold text-blue-900 dark:text-blue-100">
        Search Results for "{{ search_query }}"
      </h2>
      <p class="text-sm text-blue-700 dark:text-blue-300">
        Found {{ news_posts|length }} result{{ news_posts|length|pluralize }}
      </p>
    </div>
    <div class="flex space-x-2">
      <a 
        href="{% url 'home' %}" 
        class="inline-flex items-center px-3 py-2 text-sm font-medium text-blue-700 bg-blue-100 border border-blue-300 rounded-md hover:bg-blue-200 dark:bg-blue-800 dark:text-blue-200 dark:border-blue-600 dark:hover:bg-blue-700"
      >
        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
        </svg>
        Clear Search
      </a>
    </div>
  </div>
</div>
{% endif %}

<!-- No Results Message -->
{% if search_query and news_posts|length == 0 %}
<div class="text-center py-12">
  <div class="mx-auto w-24 h-24 text-gray-400 mb-4">
    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
    </svg>
  </div>
  <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-2">No results found</h3>
  <p class="text-gray-500 dark:text-gray-400 mb-4">
    We couldn't find any news posts matching "{{ search_query }}"
  </p>
  <a 
    href="{% url 'home' %}" 
    class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700"
  >
    View All Posts
  </a>
</div>
{% endif %}

<!-- Responsive Grid Container -->
{% if news_posts %}
<div
  class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 w-full max-w-none mx-auto"
>
  {% for post in news_posts %}
  <!-- News Post Card -->
  <div
  class="relative  bg-gray-800 text-gray-100 rounded-2xl shadow-md p-4 cursor-pointer hover:shadow-lg transition-shadow duration-300"
>
  <!-- Three Dots Menu -->
  {% if user.is_authenticated and post.author == user.username %}
  <div x-data="{ open: false }" class="absolute top-3 right-3 z-10">
    <button
      @click="open = !open"
      class="cursor-pointer w-8 h-8 flex items-center justify-center rounded-full bg-gray-700 text-gray-300 hover:text-white shadow-md transition"
    >
      <!-- three dots icon -->
      <svg
        xmlns="http://www.w3.org/2000/svg"
        class="h-5 w-5"
        viewBox="0 0 20 20"
        fill="currentColor"
      >
        <path
          d="M10 3a1.5 1.5 0 110 3 1.5 1.5 0 010-3zm0 5a1.5 1.5 0 110 3 1.5 1.5 0 010-3zm0 5a1.5 1.5 0 110 3 1.5 1.5 0 010-3z"
        />
      </svg>
    </button>
  
    <!-- Dropdown -->
    <div
      x-show="open"
      @click.outside="open = !open"
      class="absolute right-0 mt-2 w-28 bg-gray-700 rounded-lg shadow-lg py-2 text-sm"
    >
      <a href="{% url 'edit_news' post.id %}" class="block px-4 py-2 hover:bg-gray-600">Edit</a>
      <a href="{% url 'delete_news' post.id %}" class="block px-4 py-2 hover:bg-red-600 text-red-300">Delete</a>
    </div>
  </div>
  {% endif %}

  <!-- Clickable Card Content -->
  <a href="{% url 'read_news' post.id %}" class="block">
    <!-- Title -->
    <h2 class="text-xl font-bold mb-3">{{ post.title|truncatechars:70 }}</h2>

    <!-- Image -->
    <div
      class="w-full h-40 bg-gray-700 rounded-lg flex items-center justify-center overflow-hidden"
    >
      {% if post.image %}
      <img
        src="{{ post.image.url }}"
        alt="{{ post.title }}"
        class="object-cover w-full h-full rounded-lg"
      />
      {% else %}
      <img
        src="https://via.placeholder.com/300x200"
        alt="Card Image"
        class="object-cover w-full h-full rounded-lg"
      />
      {% endif %}
    </div>

    <!-- Description -->
    <p class="mt-4 text-sm">{{ post.description|truncatechars:150 }}</p>

    <!-- Footer -->
    <div
      class="flex justify-between items-center border-t border-gray-600 mt-4 pt-2 text-sm"
    >
      <span class="font-bold">Author: {{ post.author }}</span>
      <span class="text-gray-300">{{ post.created_at|date:"M d, Y" }}</span>
    </div>
  </a>
</div>
  {% endfor %}
</div>
{% elif not search_query %}
<!-- No Posts Available Message -->
<div class="text-center py-12">
  <div class="mx-auto w-24 h-24 text-gray-400 mb-4">
    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z"></path>
    </svg>
  </div>
  <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-2">No news posts available</h3>
  <p class="text-gray-500 dark:text-gray-400 mb-4">
    Be the first to create a news post!
  </p>
  <a 
    href="{% url 'create_news' %}" 
    class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700"
  >
    Create First Post
  </a>
</div>
{% endif %}

{% endblock %}
